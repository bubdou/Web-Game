<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>9 Coins Flip Game</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 20px;
  }
  #coin-container {
    display: flex;
    flex-wrap: wrap;
    width: 680px;
    margin: 20px auto;
  }
  .coin {
    width: 60px;
    height: 60px;
    line-height: 60px;
    margin: 5px;
    border: 2px solid #333;
    border-radius: 50%;
    cursor: pointer;
    user-select: none;
    font-weight: bold;
    font-size: 20px;
  }
  .black {
    background: black;
    color: white;
  }
  .white {
    background: white;
    color: black;
  }
  .selected {
    box-shadow: 0 0 5px 2px #f00;
  }
  #info {
    margin: 10px;
  }
  #actions {
    margin: 10px;
  }
  button {
    padding: 8px 16px;
    margin: 0 5px;
    cursor: pointer;
  }
  #message {
    margin-top: 20px;
    font-weight: bold;
  }
  #explanation {
    max-width: 600px;
    margin: 0 auto 30px auto;
    text-align: left;
    font-size: 16px;
    line-height: 1.5;
  }
</style>
</head>
<body>
<h1>9 Coins Flip Game</h1>

<div id="explanation">
  <h2>How to Play</h2>
  <p>You have 9 identical coins, each with a black side and a white side. Initially, there are 4 coins facing black side up and 5 coins facing white side up.</p>
  <p>In each turn, you must choose exactly 3 coins and flip them (black turns to white, white turns to black).</p>
  <p>Your goal is to make all 9 coins show the same color (either all black or all white) in as few turns as possible.</p>
  <p>Try to achieve the goal in the minimal number of turns. Good luck!</p>
</div>

<div id="info">
  <p>Current Rounds: <span id="round">0</span></p>
  <p>Black count: <span id="blackCount">0</span>, White count: <span id="whiteCount">0</span></p>
</div>

<div id="coin-container"></div>

<div id="actions">
  <button id="flipBtn">Flip Selected Coins</button>
  <button id="resetBtn">Reset Game</button>
</div>

<p id="message"></p>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const coinContainer = document.getElementById('coin-container');
  const roundDisplay = document.getElementById('round');
  const blackCountDisplay = document.getElementById('blackCount');
  const whiteCountDisplay = document.getElementById('whiteCount');
  const message = document.getElementById('message');
  const flipBtn = document.getElementById('flipBtn');
  const resetBtn = document.getElementById('resetBtn');

  let coins;   // 'B' for black-up, 'W' for white-up
  let round;   // track number of rounds
  let selectedIndices = []; // indices of selected coins for flipping

  function initGame() {
    // Initial state: first 4 are black, last 5 are white
    coins = ['B','B','B','B','W','W','W','W','W'];
    round = 0;
    selectedIndices = [];
    renderCoins();
    updateInfo();
    message.textContent = '';
  }

  // Render the 9 coins on the page
  function renderCoins() {
    coinContainer.innerHTML = '';
    coins.forEach((state, index) => {
      const c = document.createElement('div');
      c.classList.add('coin');
      if (state === 'B') {
        c.classList.add('black');
        c.textContent = 'B';
      } else {
        c.classList.add('white');
        c.textContent = 'W';
      }

      // Highlight if selected
      if (selectedIndices.includes(index)) {
        c.classList.add('selected');
      }

      c.addEventListener('click', () => toggleSelect(index));
      coinContainer.appendChild(c);
    });
  }

  // Select or deselect a coin
  function toggleSelect(index) {
    if (selectedIndices.includes(index)) {
      // Deselect if already selected
      selectedIndices = selectedIndices.filter(i => i !== index);
    } else {
      // Select if not selected yet
      if (selectedIndices.length < 3) {
        selectedIndices.push(index);
      } else {
        // Can't select more than 3 in one round
        message.textContent = 'You can only choose exactly 3 coins per round!';
        return;
      }
    }
    renderCoins();
  }

  // Flip the selected 3 coins
  function flipSelected() {
    if (selectedIndices.length !== 3) {
      message.textContent = 'Please select 3 coins before flipping!';
      return;
    }

    selectedIndices.forEach(idx => {
      coins[idx] = (coins[idx] === 'B') ? 'W' : 'B';
    });

    round++;
    selectedIndices = [];
    renderCoins();
    updateInfo();
    checkWin();
  }

  // Update the displayed round, black and white counts
  function updateInfo() {
    const blackCount = coins.filter(c => c === 'B').length;
    const whiteCount = 9 - blackCount;

    roundDisplay.textContent = round;
    blackCountDisplay.textContent = blackCount;
    whiteCountDisplay.textContent = whiteCount;
  }

  // Check if all are black or all are white
  function checkWin() {
    const blackCount = coins.filter(c => c === 'B').length;
    if (blackCount === 9) {
      message.textContent = `Congratulations! All coins are black after ${round} rounds!`;
    } else if (blackCount === 0) {
      message.textContent = `Congratulations! All coins are white after ${round} rounds!`;
    } else {
      message.textContent = '';
    }
  }

  flipBtn.addEventListener('click', flipSelected);
  resetBtn.addEventListener('click', initGame);

  initGame();
});
</script>
</body>
</html>
